<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Connect | Webview</title>
    <link rel="icon" href="data:;base64,=">
  </head>

  <body>
    <div>
      <h1 id="status"></h1>
      <input type="button" value="Call" id="button-call" />
      <br>
      <p id="resource-pool"></p>
      <p><a href="https://github.com/hapi-robo/connect-webview/">GitHub</a></p>
    </div>

    <script type="text/javascript">
      const RESOURCE_POOL_ID = 'DH3E1hCBmF006op06QLd';

      // Button event listener
      const buttonCall = document.querySelector('#button-call');
      buttonCall.addEventListener('click', () => {
        // Check if this device is using Connect
        if (typeof connect !== "undefined") {
          connect.call(RESOURCE_POOL_ID);
        } else {
          alert("Sorry, this will only work on Connect");
        }
      });

      // Status listener
      function onStatusChange(availableMembers) {
        let status = document.querySelector('#status');
        if (availableMembers > 0) {
          status.innerHTML = `Available (${availableMembers})`;
        } else {
          status.innerHTML = 'Unavailable';
        }
      }

      window.onload = function() {
        document.querySelector('#resource-pool').innerHTML = `Resource Pool: ${RESOURCE_POOL_ID}`;
        if (typeof connect !== "undefined") {
          // Register status listener
          connect.addStatusListener('onStatusChange', RESOURCE_POOL_ID);
        }
      };
    </script> 
  </body>
</html>
